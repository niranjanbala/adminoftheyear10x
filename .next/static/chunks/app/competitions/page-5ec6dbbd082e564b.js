(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[663],{2523:(e,t,s)=>{"use strict";s.d(t,{p:()=>n});var i=s(5155),a=s(2115),r=s(9434);let n=a.forwardRef((e,t)=>{let{className:s,type:a,...n}=e;return(0,i.jsx)("input",{type:a,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...n})});n.displayName="Input"},5057:(e,t,s)=>{"use strict";s.d(t,{J:()=>d});var i=s(5155),a=s(2115),r=s(968),n=s(2085),l=s(9434);let o=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,i.jsx)(r.b,{ref:t,className:(0,l.cn)(o(),s),...a})});d.displayName=r.b.displayName},7141:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>E});var i=s(5155),a=s(2115),r=s(6117),n=s(6695),l=s(6126),o=s(285),d=s(2523),c=s(8893),m=s(6474),u=s(7863),p=s(5196),x=s(9434);let h=c.bL;c.YJ;let g=c.WT,f=a.forwardRef((e,t)=>{let{className:s,children:a,...r}=e;return(0,i.jsxs)(c.l9,{ref:t,className:(0,x.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...r,children:[a,(0,i.jsx)(c.In,{asChild:!0,children:(0,i.jsx)(m.A,{className:"h-4 w-4 opacity-50"})})]})});f.displayName=c.l9.displayName;let j=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,i.jsx)(c.PP,{ref:t,className:(0,x.cn)("flex cursor-default items-center justify-center py-1",s),...a,children:(0,i.jsx)(u.A,{className:"h-4 w-4"})})});j.displayName=c.PP.displayName;let v=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,i.jsx)(c.wn,{ref:t,className:(0,x.cn)("flex cursor-default items-center justify-center py-1",s),...a,children:(0,i.jsx)(m.A,{className:"h-4 w-4"})})});v.displayName=c.wn.displayName;let b=a.forwardRef((e,t)=>{let{className:s,children:a,position:r="popper",...n}=e;return(0,i.jsx)(c.ZL,{children:(0,i.jsxs)(c.UC,{ref:t,className:(0,x.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:r,...n,children:[(0,i.jsx)(j,{}),(0,i.jsx)(c.LM,{className:(0,x.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,i.jsx)(v,{})]})})});b.displayName=c.UC.displayName,a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,i.jsx)(c.JU,{ref:t,className:(0,x.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...a})}).displayName=c.JU.displayName;let N=a.forwardRef((e,t)=>{let{className:s,children:a,...r}=e;return(0,i.jsxs)(c.q7,{ref:t,className:(0,x.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...r,children:[(0,i.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,i.jsx)(c.VF,{children:(0,i.jsx)(p.A,{className:"h-4 w-4"})})}),(0,i.jsx)(c.p4,{children:a})]})});N.displayName=c.q7.displayName,a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,i.jsx)(c.wv,{ref:t,className:(0,x.cn)("-mx-1 my-1 h-px bg-muted",s),...a})}).displayName=c.wv.displayName;var y=s(8947),_=s(5031),w=s(6874),C=s.n(w);function V(e){let{showCreateButton:t=!1,onCreateClick:s}=e,{user:r}=(0,_.A)(),[c,m]=(0,a.useState)([]),[u,p]=(0,a.useState)(!0),[x,j]=(0,a.useState)(""),[v,w]=(0,a.useState)("all"),[V,k]=(0,a.useState)("all");(0,a.useEffect)(()=>{(async()=>{try{let e={};"all"!==v&&(e.tier=v),"all"!==V&&(e.status=V);let t=await y.lX.getAll(e);m(t)}catch(e){console.error("Error fetching competitions:",e)}finally{p(!1)}})()},[v,V]);let R=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Not set",S=c.filter(e=>e.title.toLowerCase().includes(x.toLowerCase())||e.description&&e.description.toLowerCase().includes(x.toLowerCase()));return u?(0,i.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,i.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary"})}):(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-2xl font-bold",children:"Competitions"}),(0,i.jsx)("p",{className:"text-muted-foreground",children:"Discover and participate in HubSpot Admin competitions"})]}),t&&(0,i.jsx)(o.$,{onClick:s,children:"Create Competition"})]}),(0,i.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,i.jsx)("div",{className:"flex-1",children:(0,i.jsx)(d.p,{placeholder:"Search competitions...",value:x,onChange:e=>j(e.target.value)})}),(0,i.jsxs)(h,{value:v,onValueChange:w,children:[(0,i.jsx)(f,{className:"w-full md:w-48",children:(0,i.jsx)(g,{placeholder:"Filter by tier"})}),(0,i.jsxs)(b,{children:[(0,i.jsx)(N,{value:"all",children:"All Tiers"}),(0,i.jsx)(N,{value:"local",children:"Local"}),(0,i.jsx)(N,{value:"national",children:"National"}),(0,i.jsx)(N,{value:"global",children:"Global"})]})]}),(0,i.jsxs)(h,{value:V,onValueChange:k,children:[(0,i.jsx)(f,{className:"w-full md:w-48",children:(0,i.jsx)(g,{placeholder:"Filter by status"})}),(0,i.jsxs)(b,{children:[(0,i.jsx)(N,{value:"all",children:"All Status"}),(0,i.jsx)(N,{value:"registration_open",children:"Registration Open"}),(0,i.jsx)(N,{value:"voting_open",children:"Voting Open"}),(0,i.jsx)(N,{value:"completed",children:"Completed"})]})]})]}),0===S.length?(0,i.jsxs)("div",{className:"text-center py-12",children:[(0,i.jsx)("div",{className:"mb-4",children:(0,i.jsx)("svg",{className:"w-16 h-16 mx-auto text-muted-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,i.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),(0,i.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No competitions found"}),(0,i.jsx)("p",{className:"text-muted-foreground",children:x||"all"!==v||"all"!==V?"Try adjusting your filters to see more competitions.":"There are no competitions available at the moment."})]}):(0,i.jsx)("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6",children:S.map(e=>(0,i.jsxs)(n.Zp,{className:"hover:shadow-lg transition-shadow",children:[(0,i.jsxs)(n.aR,{children:[(0,i.jsx)("div",{className:"flex items-start justify-between",children:(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)(n.ZB,{className:"text-lg mb-2",children:e.title}),(0,i.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,i.jsx)(l.E,{className:(e=>{switch(e){case"local":return"bg-green-100 text-green-800 border-green-200";case"national":return"bg-blue-100 text-blue-800 border-blue-200";case"global":return"bg-purple-100 text-purple-800 border-purple-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(e.tier),children:e.tier}),(0,i.jsx)(l.E,{className:(e=>{switch(e){case"draft":default:return"bg-gray-100 text-gray-800 border-gray-200";case"registration_open":return"bg-blue-100 text-blue-800 border-blue-200";case"registration_closed":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"voting_open":return"bg-green-100 text-green-800 border-green-200";case"voting_closed":return"bg-purple-100 text-purple-800 border-purple-200";case"completed":return"bg-red-100 text-red-800 border-red-200"}})(e.status),children:(e=>{let t=new Date,s=e.registration_start?new Date(e.registration_start):null,i=e.registration_end?new Date(e.registration_end):null,a=e.voting_start?new Date(e.voting_start):null,r=e.voting_end?new Date(e.voting_end):null;return"draft"===e.status?"Draft":s&&t<s?"Upcoming":s&&i&&t>=s&&t<=i?"Registration Open":i&&a&&t>i&&t<a?"Registration Closed":a&&r&&t>=a&&t<=r?"Voting Open":r&&t>r?"Completed":"Unknown"})(e)})]})]})}),e.country&&(0,i.jsxs)("p",{className:"text-sm text-muted-foreground",children:["\uD83D\uDCCD ",e.country]})]}),(0,i.jsxs)(n.Wu,{children:[e.description&&(0,i.jsx)(n.BT,{className:"mb-4 line-clamp-3",children:e.description}),(0,i.jsxs)("div",{className:"space-y-2 text-sm text-muted-foreground mb-4",children:[(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{children:"Registration:"}),(0,i.jsxs)("span",{children:[R(e.registration_start)," - ",R(e.registration_end)]})]}),(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{children:"Voting:"}),(0,i.jsxs)("span",{children:[R(e.voting_start)," - ",R(e.voting_end)]})]}),e.max_participants&&(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{children:"Max Participants:"}),(0,i.jsx)("span",{children:e.max_participants})]})]}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)(o.$,{asChild:!0,className:"flex-1",children:(0,i.jsx)(C(),{href:"/competitions/".concat(e.id),children:"View Details"})}),r&&(0,i.jsx)(o.$,{variant:"outline",asChild:!0,children:(0,i.jsx)(C(),{href:"/competitions/".concat(e.id,"/participate"),children:"Participate"})})]})]})]},e.id))})]})}var k=s(2177),R=s(3560),S=s(927),A=s(5057),D=s(8539);let q=S.Ik({title:S.Yj().min(3,"Title must be at least 3 characters").max(100,"Title must be less than 100 characters"),description:S.Yj().max(1e3,"Description must be less than 1000 characters").optional(),tier:S.k5(["local","national","global"]),country:S.Yj().min(2,"Country is required").optional(),registration_start:S.Yj().min(1,"Registration start date is required"),registration_end:S.Yj().min(1,"Registration end date is required"),voting_start:S.Yj().min(1,"Voting start date is required"),voting_end:S.Yj().min(1,"Voting end date is required"),max_participants:S.ai().min(1,"Must allow at least 1 participant").max(1e3,"Maximum 1000 participants").optional(),qualification_rules:S.Ik({requiresApproval:S.zM(),topN:S.ai().min(1).max(100).optional(),minVotes:S.ai().min(0).optional()})});function F(e){var t,s,r;let{onSuccess:l,onCancel:c,initialData:m,isEditing:u=!1}=e,{user:p}=(0,_.A)(),[x,j]=(0,a.useState)(!1),{register:v,handleSubmit:w,formState:{errors:C},setValue:V,watch:S,reset:F}=(0,k.mN)({resolver:(0,R.u)(q),defaultValues:{title:(null==m?void 0:m.title)||"",description:(null==m?void 0:m.description)||"",tier:(null==m?void 0:m.tier)||"local",country:(null==m?void 0:m.country)||"",registration_start:(null==m?void 0:m.registration_start)||"",registration_end:(null==m?void 0:m.registration_end)||"",voting_start:(null==m?void 0:m.voting_start)||"",voting_end:(null==m?void 0:m.voting_end)||"",max_participants:(null==m?void 0:m.max_participants)||void 0,qualification_rules:{requiresApproval:(null==m||null==(t=m.qualification_rules)?void 0:t.requiresApproval)||!0,topN:(null==m||null==(s=m.qualification_rules)?void 0:s.topN)||3,minVotes:(null==m||null==(r=m.qualification_rules)?void 0:r.minVotes)||0}}}),E=S("tier"),J=async e=>{if(p)try{j(!0);let t=new Date(e.registration_start),s=new Date(e.registration_end),i=new Date(e.voting_start),a=new Date(e.voting_end);if(t>=s)throw Error("Registration end must be after registration start");if(s>i)throw Error("Voting start must be after registration end");if(i>=a)throw Error("Voting end must be after voting start");let r={title:e.title,description:e.description||null,tier:e.tier,country:"local"===e.tier?e.country:null,status:"draft",registration_start:e.registration_start,registration_end:e.registration_end,voting_start:e.voting_start,voting_end:e.voting_end,max_participants:e.max_participants||null,qualification_rules:e.qualification_rules,created_by:p.id},n=await y.lX.create(r);null==l||l(n)}catch(e){console.error("Error creating competition:",e),alert(e instanceof Error?e.message:"Failed to create competition")}finally{j(!1)}};return(0,i.jsx)("div",{className:"max-w-4xl mx-auto space-y-6",children:(0,i.jsxs)(n.Zp,{children:[(0,i.jsxs)(n.aR,{children:[(0,i.jsx)(n.ZB,{children:u?"Edit Competition":"Create New Competition"}),(0,i.jsx)(n.BT,{children:"Set up a new HubSpot Admin competition with all the necessary details"})]}),(0,i.jsx)(n.Wu,{children:(0,i.jsxs)("form",{onSubmit:w(J),className:"space-y-6",children:[(0,i.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(A.J,{htmlFor:"title",children:"Competition Title *"}),(0,i.jsx)(d.p,{id:"title",...v("title"),placeholder:"e.g., HubSpot Admin Challenge 2024"}),C.title&&(0,i.jsx)("p",{className:"text-sm text-destructive",children:C.title.message})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(A.J,{htmlFor:"tier",children:"Competition Tier *"}),(0,i.jsxs)(h,{onValueChange:e=>V("tier",e),children:[(0,i.jsx)(f,{children:(0,i.jsx)(g,{placeholder:"Select tier"})}),(0,i.jsxs)(b,{children:[(0,i.jsx)(N,{value:"local",children:"Local"}),(0,i.jsx)(N,{value:"national",children:"National"}),(0,i.jsx)(N,{value:"global",children:"Global"})]})]}),C.tier&&(0,i.jsx)("p",{className:"text-sm text-destructive",children:C.tier.message})]})]}),"local"===E&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(A.J,{htmlFor:"country",children:"Country *"}),(0,i.jsx)(d.p,{id:"country",...v("country"),placeholder:"e.g., United States, Canada, United Kingdom"}),C.country&&(0,i.jsx)("p",{className:"text-sm text-destructive",children:C.country.message})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(A.J,{htmlFor:"description",children:"Description"}),(0,i.jsx)(D.T,{id:"description",...v("description"),placeholder:"Describe the competition, its goals, and what participants should expect...",rows:4}),C.description&&(0,i.jsx)("p",{className:"text-sm text-destructive",children:C.description.message})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(A.J,{htmlFor:"max_participants",children:"Maximum Participants"}),(0,i.jsx)(d.p,{id:"max_participants",type:"number",...v("max_participants",{valueAsNumber:!0}),placeholder:"Leave empty for unlimited"}),C.max_participants&&(0,i.jsx)("p",{className:"text-sm text-destructive",children:C.max_participants.message})]}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold",children:"Competition Timeline"}),(0,i.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(A.J,{htmlFor:"registration_start",children:"Registration Start *"}),(0,i.jsx)(d.p,{id:"registration_start",type:"datetime-local",...v("registration_start")}),C.registration_start&&(0,i.jsx)("p",{className:"text-sm text-destructive",children:C.registration_start.message})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(A.J,{htmlFor:"registration_end",children:"Registration End *"}),(0,i.jsx)(d.p,{id:"registration_end",type:"datetime-local",...v("registration_end")}),C.registration_end&&(0,i.jsx)("p",{className:"text-sm text-destructive",children:C.registration_end.message})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(A.J,{htmlFor:"voting_start",children:"Voting Start *"}),(0,i.jsx)(d.p,{id:"voting_start",type:"datetime-local",...v("voting_start")}),C.voting_start&&(0,i.jsx)("p",{className:"text-sm text-destructive",children:C.voting_start.message})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(A.J,{htmlFor:"voting_end",children:"Voting End *"}),(0,i.jsx)(d.p,{id:"voting_end",type:"datetime-local",...v("voting_end")}),C.voting_end&&(0,i.jsx)("p",{className:"text-sm text-destructive",children:C.voting_end.message})]})]})]}),(0,i.jsxs)("div",{className:"space-y-4",children:[(0,i.jsx)("h3",{className:"text-lg font-semibold",children:"Qualification Rules"}),(0,i.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(A.J,{htmlFor:"topN",children:"Winners to Advance"}),(0,i.jsx)(d.p,{id:"topN",type:"number",...v("qualification_rules.topN",{valueAsNumber:!0}),placeholder:"3"}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground",children:"Number of top participants to advance to next tier"})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(A.J,{htmlFor:"minVotes",children:"Minimum Votes Required"}),(0,i.jsx)(d.p,{id:"minVotes",type:"number",...v("qualification_rules.minVotes",{valueAsNumber:!0}),placeholder:"0"}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground",children:"Minimum votes needed to be eligible for advancement"})]})]})]}),(0,i.jsxs)("div",{className:"flex gap-4",children:[(0,i.jsx)(o.$,{type:"submit",disabled:x,children:x?"Creating...":u?"Update Competition":"Create Competition"}),c&&(0,i.jsx)(o.$,{type:"button",variant:"outline",onClick:c,children:"Cancel"}),(0,i.jsx)(o.$,{type:"button",variant:"outline",onClick:()=>F(),children:"Reset"})]})]})})]})})}function E(){let{user:e}=(0,_.A)(),[t,s]=(0,a.useState)(!1),n=!!(e&&("organizer"===e.role||"super_admin"===e.role));return(0,i.jsx)(r.O,{children:(0,i.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,i.jsx)("div",{className:"container mx-auto px-4 py-8",children:t?(0,i.jsxs)("div",{className:"space-y-6",children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{className:"text-3xl font-bold",children:"Create Competition"}),(0,i.jsx)("p",{className:"text-muted-foreground",children:"Set up a new HubSpot Admin competition"})]}),(0,i.jsx)(o.$,{variant:"outline",onClick:()=>s(!1),children:"Back to Competitions"})]}),(0,i.jsx)(F,{onSuccess:e=>{s(!1),window.location.href="/competitions/".concat(e.id)},onCancel:()=>s(!1)})]}):(0,i.jsx)(V,{showCreateButton:n,onCreateClick:()=>s(!0)})})})})}},7761:(e,t,s)=>{Promise.resolve().then(s.bind(s,7141))},8539:(e,t,s)=>{"use strict";s.d(t,{T:()=>n});var i=s(5155),a=s(2115),r=s(9434);let n=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,i.jsx)("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...a})});n.displayName="Textarea"}},e=>{e.O(0,[579,352,874,942,647,217,971,657,441,964,358],()=>e(e.s=7761)),_N_E=e.O()}]);