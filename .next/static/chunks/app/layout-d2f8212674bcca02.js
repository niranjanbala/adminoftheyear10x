(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{347:()=>{},1760:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=1760,e.exports=t},5031:(e,t,r)=>{"use strict";r.d(t,{A:()=>l,AuthProvider:()=>s});var o=r(5155),i=r(2115),a=r(3579);let n=(0,i.createContext)(void 0);function s(e){let{children:t}=e,[r,s]=(0,i.useState)(null),[l,u]=(0,i.useState)(!0),[c]=(0,i.useState)(()=>(0,a.createClientComponentClient)());(0,i.useEffect)(()=>{if(!c)return void u(!1);(async()=>{try{let{data:{session:e}}=await c.auth.getSession();(null==e?void 0:e.user)&&await h(e.user.id)}catch(e){console.error("Error getting initial session:",e)}finally{u(!1)}})();let{data:{subscription:e}}=c.auth.onAuthStateChange(async(e,t)=>{"SIGNED_IN"===e&&(null==t?void 0:t.user)?await h(t.user.id):"SIGNED_OUT"===e&&s(null),u(!1)});return()=>e.unsubscribe()},[c]);let h=async e=>{if(c)try{let{data:t,error:r}=await c.from("users").select("*").eq("id",e).single();if(r)throw r;s({id:t.id,email:t.email,hubspot_id:t.hubspot_id,display_name:t.display_name,role:t.role,verification_status:t.verification_status})}catch(e){console.error("Error fetching user profile:",e),s(null)}},d=async()=>{try{u(!0);let e=await fetch("/api/auth/hubspot/initiate",{method:"GET"});if(!e.ok)throw Error("Failed to initiate HubSpot authentication");let{authUrl:t}=await e.json();window.location.href=t}catch(e){throw console.error("HubSpot sign-in error:",e),u(!1),e}},f=async()=>{if(c)try{u(!0),await fetch("/api/auth/logout",{method:"POST"}),await c.auth.signOut(),s(null)}catch(e){throw console.error("Sign out error:",e),e}finally{u(!1)}},w=async()=>{try{if(!(await fetch("/api/auth/refresh",{method:"POST"})).ok)throw Error("Failed to refresh tokens")}catch(e){throw console.error("Token refresh error:",e),e}};return(0,o.jsx)(n.Provider,{value:{user:r,loading:l,signInWithHubSpot:d,signOut:f,refreshTokens:w},children:t})}function l(){let e=(0,i.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},8346:e=>{e.exports={style:{fontFamily:"'Inter', 'Inter Fallback'",fontStyle:"normal"},className:"__className_e8ce0c"}},9392:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,8346,23)),Promise.resolve().then(r.t.bind(r,347,23)),Promise.resolve().then(r.bind(r,5031))}},e=>{e.O(0,[838,579,441,964,358],()=>e(e.s=9392)),_N_E=e.O()}]);