(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{285:(e,t,s)=>{"use strict";s.d(t,{$:()=>d});var r=s(5155),a=s(2115),n=s(9708),i=s(2085),o=s(9434);let l=(0,i.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,t)=>{let{className:s,variant:a,size:i,asChild:d=!1,...c}=e,u=d?n.DX:"button";return(0,r.jsx)(u,{className:(0,o.cn)(l({variant:a,size:i,className:s})),ref:t,...c})});d.displayName="Button"},756:(e,t,s)=>{Promise.resolve().then(s.bind(s,3642))},1760:e=>{function t(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}t.keys=()=>[],t.resolve=t,t.id=1760,e.exports=t},3642:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>N});var r=s(5155),a=s(5031),n=s(2115),i=s(285);function o(e){let{variant:t="default",size:s="default",className:o,children:l}=e,{signInWithHubSpot:d,loading:c}=(0,a.A)(),[u,m]=(0,n.useState)(!1),f=async()=>{try{m(!0),await d()}catch(e){console.error("Login failed:",e)}finally{m(!1)}};return(0,r.jsx)(i.$,{variant:t,size:s,className:o,onClick:f,disabled:c||u,children:u?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Connecting..."]}):l||(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",fill:"currentColor",children:(0,r.jsx)("path",{d:"M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm5.568 8.16c-.169 1.858-.896 3.433-2.043 4.568-1.258 1.249-2.97 1.93-4.814 1.93-1.843 0-3.556-.681-4.814-1.93-1.147-1.135-1.874-2.71-2.043-4.568-.027-.312.207-.576.52-.576h.896c.261 0 .48.183.53.437.123 1.25.634 2.394 1.434 3.188.8.794 1.87 1.232 3.014 1.232s2.214-.438 3.014-1.232c.8-.794 1.311-1.938 1.434-3.188.05-.254.269-.437.53-.437h.896c.313 0 .547.264.52.576z"})}),"Sign in with HubSpot"]})})}var l=s(8283),d=s(3052),c=s(5196),u=s(9428),m=s(9434);let f=l.bL,x=l.l9;l.YJ,l.ZL,l.Pb,l.z6,n.forwardRef((e,t)=>{let{className:s,inset:a,children:n,...i}=e;return(0,r.jsxs)(l.ZP,{ref:t,className:(0,m.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",a&&"pl-8",s),...i,children:[n,(0,r.jsx)(d.A,{className:"ml-auto h-4 w-4"})]})}).displayName=l.ZP.displayName,n.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(l.G5,{ref:t,className:(0,m.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...a})}).displayName=l.G5.displayName;let h=n.forwardRef((e,t)=>{let{className:s,sideOffset:a=4,...n}=e;return(0,r.jsx)(l.ZL,{children:(0,r.jsx)(l.UC,{ref:t,sideOffset:a,className:(0,m.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...n})})});h.displayName=l.UC.displayName;let p=n.forwardRef((e,t)=>{let{className:s,inset:a,...n}=e;return(0,r.jsx)(l.q7,{ref:t,className:(0,m.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a&&"pl-8",s),...n})});p.displayName=l.q7.displayName,n.forwardRef((e,t)=>{let{className:s,children:a,checked:n,...i}=e;return(0,r.jsxs)(l.H_,{ref:t,className:(0,m.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),checked:n,...i,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(l.VF,{children:(0,r.jsx)(c.A,{className:"h-4 w-4"})})}),a]})}).displayName=l.H_.displayName,n.forwardRef((e,t)=>{let{className:s,children:a,...n}=e;return(0,r.jsxs)(l.hN,{ref:t,className:(0,m.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...n,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(l.VF,{children:(0,r.jsx)(u.A,{className:"h-2 w-2 fill-current"})})}),a]})}).displayName=l.hN.displayName;let g=n.forwardRef((e,t)=>{let{className:s,inset:a,...n}=e;return(0,r.jsx)(l.JU,{ref:t,className:(0,m.cn)("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",s),...n})});g.displayName=l.JU.displayName;let y=n.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(l.wv,{ref:t,className:(0,m.cn)("-mx-1 my-1 h-px bg-muted",s),...a})});function j(){let{user:e,signOut:t,loading:s}=(0,a.A)(),[o,l]=(0,n.useState)(!1);if(!e||s)return null;let d=async()=>{try{l(!0),await t()}catch(e){console.error("Logout failed:",e)}finally{l(!1)}};return(0,r.jsxs)(f,{children:[(0,r.jsx)(x,{asChild:!0,children:(0,r.jsx)(i.$,{variant:"ghost",className:"relative h-8 w-8 rounded-full",children:(0,r.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-primary text-primary-foreground",children:e.display_name.charAt(0).toUpperCase()})})}),(0,r.jsxs)(h,{className:"w-56",align:"end",forceMount:!0,children:[(0,r.jsx)(g,{className:"font-normal",children:(0,r.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,r.jsx)("p",{className:"text-sm font-medium leading-none",children:e.display_name}),(0,r.jsx)("p",{className:"text-xs leading-none text-muted-foreground",children:e.email}),(0,r.jsxs)("div",{className:"flex gap-1 mt-2",children:[(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat((e=>{switch(e){case"super_admin":return"bg-red-100 text-red-800";case"organizer":return"bg-blue-100 text-blue-800";case"voter":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}})(e.role)),children:e.role.replace("_"," ")}),(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat((e=>{switch(e){case"verified":return"bg-green-100 text-green-800";case"pending":return"bg-yellow-100 text-yellow-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(e.verification_status)),children:e.verification_status})]})]})}),(0,r.jsx)(y,{}),(0,r.jsx)(p,{children:"Profile"}),(0,r.jsx)(p,{children:"Settings"}),("organizer"===e.role||"super_admin"===e.role)&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(y,{}),(0,r.jsx)(p,{children:"Admin Dashboard"})]}),(0,r.jsx)(y,{}),(0,r.jsx)(p,{onClick:d,disabled:o,children:o?"Signing out...":"Sign out"})]})]})}y.displayName=l.wv.displayName;var v=s(6874),b=s.n(v);function N(){let{user:e,loading:t}=(0,a.A)();return(0,r.jsxs)("main",{className:"flex min-h-screen flex-col",children:[(0,r.jsx)("header",{className:"border-b",children:(0,r.jsxs)("div",{className:"container mx-auto px-4 py-4 flex justify-between items-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"HubSpot Admin Competition"}),(0,r.jsx)("div",{className:"flex items-center space-x-4",children:t?(0,r.jsx)("div",{className:"animate-pulse h-8 w-8 bg-gray-200 rounded-full"}):e?(0,r.jsx)(j,{}):(0,r.jsx)(o,{})})]})}),(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center p-8",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto text-center space-y-8",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h2",{className:"text-4xl font-bold tracking-tight",children:"Welcome to the Global Competition"}),(0,r.jsx)("p",{className:"text-xl text-muted-foreground max-w-2xl mx-auto",children:"Compete with HubSpot admins worldwide and showcase your expertise. Participate in local, national, and global competitions to prove you're the best."})]}),e?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("p",{className:"text-lg",children:["Welcome back, ",(0,r.jsx)("span",{className:"font-semibold",children:e.display_name}),"!"]}),(0,r.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,r.jsx)(i.$,{asChild:!0,size:"lg",children:(0,r.jsx)(b(),{href:"/competitions",children:"View Competitions"})}),(0,r.jsx)(i.$,{variant:"outline",size:"lg",asChild:!0,children:(0,r.jsx)(b(),{href:"/profile",children:"My Profile"})})]})]}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("p",{className:"text-lg text-muted-foreground",children:"Sign in with your HubSpot account to get started"}),(0,r.jsx)(o,{size:"lg"})]}),(0,r.jsxs)("div",{className:"grid md:grid-cols-3 gap-8 mt-16",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center mx-auto",children:(0,r.jsxs)("svg",{className:"w-6 h-6 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Local to Global"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Start local, compete nationally, and advance to the global finale"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center mx-auto",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Verified Voting"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Only verified HubSpot users can vote, ensuring fair competition"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center mx-auto",children:(0,r.jsx)("svg",{className:"w-6 h-6 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),(0,r.jsx)("h3",{className:"text-lg font-semibold",children:"Real-time Results"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Watch live leaderboards and see results update in real-time"})]})]})]})})]})}},5031:(e,t,s)=>{"use strict";s.d(t,{A:()=>l,AuthProvider:()=>o});var r=s(5155),a=s(2115),n=s(3579);let i=(0,a.createContext)(void 0);function o(e){let{children:t}=e,[s,o]=(0,a.useState)(null),[l,d]=(0,a.useState)(!0),[c]=(0,a.useState)(()=>(0,n.createClientComponentClient)());(0,a.useEffect)(()=>{if(!c)return void d(!1);(async()=>{try{let{data:{session:e}}=await c.auth.getSession();(null==e?void 0:e.user)&&await u(e.user.id)}catch(e){console.error("Error getting initial session:",e)}finally{d(!1)}})();let{data:{subscription:e}}=c.auth.onAuthStateChange(async(e,t)=>{"SIGNED_IN"===e&&(null==t?void 0:t.user)?await u(t.user.id):"SIGNED_OUT"===e&&o(null),d(!1)});return()=>e.unsubscribe()},[c]);let u=async e=>{if(c)try{let{data:t,error:s}=await c.from("users").select("*").eq("id",e).single();if(s)throw s;o({id:t.id,email:t.email,hubspot_id:t.hubspot_id,display_name:t.display_name,role:t.role,verification_status:t.verification_status})}catch(e){console.error("Error fetching user profile:",e),o(null)}},m=async()=>{try{d(!0);let e=await fetch("/api/auth/hubspot/initiate",{method:"GET"});if(!e.ok)throw Error("Failed to initiate HubSpot authentication");let{authUrl:t}=await e.json();window.location.href=t}catch(e){throw console.error("HubSpot sign-in error:",e),d(!1),e}},f=async()=>{if(c)try{d(!0),await fetch("/api/auth/logout",{method:"POST"}),await c.auth.signOut(),o(null)}catch(e){throw console.error("Sign out error:",e),e}finally{d(!1)}},x=async()=>{try{if(!(await fetch("/api/auth/refresh",{method:"POST"})).ok)throw Error("Failed to refresh tokens")}catch(e){throw console.error("Token refresh error:",e),e}};return(0,r.jsx)(i.Provider,{value:{user:s,loading:l,signInWithHubSpot:m,signOut:f,refreshTokens:x},children:t})}function l(){let e=(0,a.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},9434:(e,t,s)=>{"use strict";s.d(t,{cn:()=>n});var r=s(2596),a=s(9688);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.QP)((0,r.$)(t))}}},e=>{e.O(0,[579,503,546,441,964,358],()=>e(e.s=756)),_N_E=e.O()}]);