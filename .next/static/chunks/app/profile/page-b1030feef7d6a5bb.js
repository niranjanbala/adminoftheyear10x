(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{285:(e,r,s)=>{"use strict";s.d(r,{$:()=>c});var t=s(5155),i=s(2115),l=s(9708),a=s(2085),n=s(9434);let o=(0,a.F)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=i.forwardRef((e,r)=>{let{className:s,variant:i,size:a,asChild:c=!1,...d}=e,u=c?l.DX:"button";return(0,t.jsx)(u,{className:(0,n.cn)(o({variant:i,size:a,className:s})),ref:r,...d})});c.displayName="Button"},1760:e=>{function r(e){var r=Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}r.keys=()=>[],r.resolve=r,r.id=1760,e.exports=r},2523:(e,r,s)=>{"use strict";s.d(r,{p:()=>a});var t=s(5155),i=s(2115),l=s(9434);let a=i.forwardRef((e,r)=>{let{className:s,type:i,...a}=e;return(0,t.jsx)("input",{type:i,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:r,...a})});a.displayName="Input"},3155:(e,r,s)=>{"use strict";s.d(r,{M:()=>n});var t=s(5155),i=s(2115),l=s(285),a=s(5031);function n(e){let{variant:r="default",size:s="default",className:n,children:o}=e,{signInWithHubSpot:c,loading:d}=(0,a.A)(),[u,h]=(0,i.useState)(!1),m=async()=>{try{h(!0),await c()}catch(e){console.error("Login failed:",e)}finally{h(!1)}};return(0,t.jsx)(l.$,{variant:r,size:s,className:n,onClick:m,disabled:d||u,children:u?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Connecting..."]}):o||(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("svg",{className:"w-5 h-5 mr-2",viewBox:"0 0 24 24",fill:"currentColor",children:(0,t.jsx)("path",{d:"M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm5.568 8.16c-.169 1.858-.896 3.433-2.043 4.568-1.258 1.249-2.97 1.93-4.814 1.93-1.843 0-3.556-.681-4.814-1.93-1.147-1.135-1.874-2.71-2.043-4.568-.027-.312.207-.576.52-.576h.896c.261 0 .48.183.53.437.123 1.25.634 2.394 1.434 3.188.8.794 1.87 1.232 3.014 1.232s2.214-.438 3.014-1.232c.8-.794 1.311-1.938 1.434-3.188.05-.254.269-.437.53-.437h.896c.313 0 .547.264.52.576z"})}),"Sign in with HubSpot"]})})}},3655:(e,r,s)=>{"use strict";s.d(r,{hO:()=>o,sG:()=>n});var t=s(2115),i=s(7650),l=s(9708),a=s(5155),n=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,r)=>{let s=(0,l.TL)(`Primitive.${r}`),i=t.forwardRef((e,t)=>{let{asChild:i,...l}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,a.jsx)(i?s:r,{...l,ref:t})});return i.displayName=`Primitive.${r}`,{...e,[r]:i}},{});function o(e,r){e&&i.flushSync(()=>e.dispatchEvent(r))}},5031:(e,r,s)=>{"use strict";s.d(r,{A:()=>o,AuthProvider:()=>n});var t=s(5155),i=s(2115),l=s(3579);let a=(0,i.createContext)(void 0);function n(e){let{children:r}=e,[s,n]=(0,i.useState)(null),[o,c]=(0,i.useState)(!0),[d]=(0,i.useState)(()=>(0,l.createClientComponentClient)());(0,i.useEffect)(()=>{if(!d)return void c(!1);(async()=>{try{let{data:{session:e}}=await d.auth.getSession();(null==e?void 0:e.user)&&await u(e.user.id)}catch(e){console.error("Error getting initial session:",e)}finally{c(!1)}})();let{data:{subscription:e}}=d.auth.onAuthStateChange(async(e,r)=>{"SIGNED_IN"===e&&(null==r?void 0:r.user)?await u(r.user.id):"SIGNED_OUT"===e&&n(null),c(!1)});return()=>e.unsubscribe()},[d]);let u=async e=>{if(d)try{let{data:r,error:s}=await d.from("users").select("*").eq("id",e).single();if(s)throw s;n({id:r.id,email:r.email,hubspot_id:r.hubspot_id,display_name:r.display_name,role:r.role,verification_status:r.verification_status})}catch(e){console.error("Error fetching user profile:",e),n(null)}},h=async()=>{try{c(!0);let e=await fetch("/api/auth/hubspot/initiate",{method:"GET"});if(!e.ok)throw Error("Failed to initiate HubSpot authentication");let{authUrl:r}=await e.json();window.location.href=r}catch(e){throw console.error("HubSpot sign-in error:",e),c(!1),e}},m=async()=>{if(d)try{c(!0),await fetch("/api/auth/logout",{method:"POST"}),await d.auth.signOut(),n(null)}catch(e){throw console.error("Sign out error:",e),e}finally{c(!1)}},x=async()=>{try{if(!(await fetch("/api/auth/refresh",{method:"POST"})).ok)throw Error("Failed to refresh tokens")}catch(e){throw console.error("Token refresh error:",e),e}};return(0,t.jsx)(a.Provider,{value:{user:s,loading:o,signInWithHubSpot:h,signOut:m,refreshTokens:x},children:r})}function o(){let e=(0,i.useContext)(a);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},5032:(e,r,s)=>{Promise.resolve().then(s.bind(s,8638))},5057:(e,r,s)=>{"use strict";s.d(r,{J:()=>c});var t=s(5155),i=s(2115),l=s(968),a=s(2085),n=s(9434);let o=(0,a.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=i.forwardRef((e,r)=>{let{className:s,...i}=e;return(0,t.jsx)(l.b,{ref:r,className:(0,n.cn)(o(),s),...i})});c.displayName=l.b.displayName},6117:(e,r,s)=>{"use strict";s.d(r,{O:()=>n});var t=s(5155),i=s(5031),l=s(3155),a=s(6695);function n(e){let{children:r,requireRole:s,requireVerified:n=!1,fallback:o}=e,{user:c,loading:d}=(0,i.A)();if(d)return(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary"})});if(!c)return o||(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,t.jsxs)(a.Zp,{className:"w-full max-w-md",children:[(0,t.jsxs)(a.aR,{className:"text-center",children:[(0,t.jsx)(a.ZB,{className:"text-2xl font-bold",children:"Sign In Required"}),(0,t.jsx)(a.BT,{children:"You need to sign in with your HubSpot account to access this page."})]}),(0,t.jsx)(a.Wu,{children:(0,t.jsx)(l.M,{className:"w-full"})})]})});if(n&&"verified"!==c.verification_status)return(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,t.jsx)(a.Zp,{className:"w-full max-w-md",children:(0,t.jsxs)(a.aR,{className:"text-center",children:[(0,t.jsx)("div",{className:"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-yellow-100",children:(0,t.jsx)("svg",{className:"h-6 w-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,t.jsx)(a.ZB,{className:"text-2xl font-bold",children:"Account Verification Required"}),(0,t.jsxs)(a.BT,{children:["Your HubSpot account needs to be verified before you can access this feature.","pending"===c.verification_status&&" Verification is currently pending.","rejected"===c.verification_status&&" Your verification was rejected. Please contact support."]})]})})});if(s){let e={participant:0,voter:1,organizer:2,super_admin:3};if(e[c.role]<e[s])return(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,t.jsx)(a.Zp,{className:"w-full max-w-md",children:(0,t.jsxs)(a.aR,{className:"text-center",children:[(0,t.jsx)("div",{className:"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-red-100",children:(0,t.jsx)("svg",{className:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636m12.728 12.728L18.364 5.636M5.636 18.364l12.728-12.728"})})}),(0,t.jsx)(a.ZB,{className:"text-2xl font-bold",children:"Access Denied"}),(0,t.jsxs)(a.BT,{children:["You don't have the required permissions to access this page. Required role: ",s.replace("_"," ")]})]})})})}return(0,t.jsx)(t.Fragment,{children:r})}},6126:(e,r,s)=>{"use strict";s.d(r,{E:()=>n});var t=s(5155);s(2115);var i=s(2085),l=s(9434);let a=(0,i.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function n(e){let{className:r,variant:s,...i}=e;return(0,t.jsx)("div",{className:(0,l.cn)(a({variant:s}),r),...i})}},6695:(e,r,s)=>{"use strict";s.d(r,{BT:()=>c,Wu:()=>d,ZB:()=>o,Zp:()=>a,aR:()=>n});var t=s(5155),i=s(2115),l=s(9434);let a=i.forwardRef((e,r)=>{let{className:s,...i}=e;return(0,t.jsx)("div",{ref:r,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...i})});a.displayName="Card";let n=i.forwardRef((e,r)=>{let{className:s,...i}=e;return(0,t.jsx)("div",{ref:r,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",s),...i})});n.displayName="CardHeader";let o=i.forwardRef((e,r)=>{let{className:s,...i}=e;return(0,t.jsx)("h3",{ref:r,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",s),...i})});o.displayName="CardTitle";let c=i.forwardRef((e,r)=>{let{className:s,...i}=e;return(0,t.jsx)("p",{ref:r,className:(0,l.cn)("text-sm text-muted-foreground",s),...i})});c.displayName="CardDescription";let d=i.forwardRef((e,r)=>{let{className:s,...i}=e;return(0,t.jsx)("div",{ref:r,className:(0,l.cn)("p-6 pt-0",s),...i})});d.displayName="CardContent",i.forwardRef((e,r)=>{let{className:s,...i}=e;return(0,t.jsx)("div",{ref:r,className:(0,l.cn)("flex items-center p-6 pt-0",s),...i})}).displayName="CardFooter"},8539:(e,r,s)=>{"use strict";s.d(r,{T:()=>a});var t=s(5155),i=s(2115),l=s(9434);let a=i.forwardRef((e,r)=>{let{className:s,...i}=e;return(0,t.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:r,...i})});a.displayName="Textarea"},8638:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>y});var t=s(5155),i=s(2115),l=s(5031),a=s(6117),n=s(6126),o=s(285),c=s(6695);function d(e){let{user:r,isOwnProfile:s=!1,onEdit:i}=e;return(0,t.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"h-48 md:h-64 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg overflow-hidden",children:r.banner_image_url?(0,t.jsx)("img",{src:r.banner_image_url,alt:"Profile banner",className:"w-full h-full object-cover"}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center text-white",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold",children:r.display_name}),(0,t.jsx)("p",{className:"text-lg opacity-90",children:"HubSpot Admin"})]})})}),(0,t.jsx)("div",{className:"absolute -bottom-12 left-6",children:(0,t.jsx)("div",{className:"w-24 h-24 rounded-full border-4 border-white bg-white overflow-hidden",children:r.profile_picture_url?(0,t.jsx)("img",{src:r.profile_picture_url,alt:r.display_name,className:"w-full h-full object-cover"}):(0,t.jsx)("div",{className:"w-full h-full bg-primary flex items-center justify-center text-primary-foreground text-2xl font-bold",children:r.display_name.charAt(0).toUpperCase()})})}),s&&(0,t.jsx)("div",{className:"absolute top-4 right-4",children:(0,t.jsx)(o.$,{onClick:i,variant:"secondary",children:"Edit Profile"})})]}),(0,t.jsxs)("div",{className:"pt-12",children:[(0,t.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:r.display_name}),(0,t.jsx)("p",{className:"text-muted-foreground",children:r.email})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(n.E,{className:(e=>{switch(e){case"super_admin":return"bg-red-100 text-red-800 border-red-200";case"organizer":return"bg-blue-100 text-blue-800 border-blue-200";case"voter":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(r.role),children:r.role.replace("_"," ")}),(0,t.jsx)(n.E,{className:(e=>{switch(e){case"verified":return"bg-green-100 text-green-800 border-green-200";case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"rejected":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(r.verification_status),children:r.verification_status})]})]}),r.bio&&(0,t.jsx)("div",{className:"mt-6",children:(0,t.jsx)("p",{className:"text-lg leading-relaxed",children:r.bio})})]}),(0,t.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[r.hubspot_experience&&(0,t.jsxs)(c.Zp,{children:[(0,t.jsx)(c.aR,{children:(0,t.jsxs)(c.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor",children:(0,t.jsx)("path",{d:"M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm5.568 8.16c-.169 1.858-.896 3.433-2.043 4.568-1.258 1.249-2.97 1.93-4.814 1.93-1.843 0-3.556-.681-4.814-1.93-1.147-1.135-1.874-2.71-2.043-4.568-.027-.312.207-.576.52-.576h.896c.261 0 .48.183.53.437.123 1.25.634 2.394 1.434 3.188.8.794 1.87 1.232 3.014 1.232s2.214-.438 3.014-1.232c.8-.794 1.311-1.938 1.434-3.188.05-.254.269-.437.53-.437h.896c.313 0 .547.264.52.576z"})}),"HubSpot Experience"]})}),(0,t.jsx)(c.Wu,{children:(0,t.jsx)("p",{className:"text-muted-foreground",children:r.hubspot_experience})})]}),r.skills&&r.skills.length>0&&(0,t.jsxs)(c.Zp,{children:[(0,t.jsx)(c.aR,{children:(0,t.jsx)(c.ZB,{children:"Skills"})}),(0,t.jsx)(c.Wu,{children:(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:r.skills.map(e=>(0,t.jsx)(n.E,{variant:"secondary",children:e},e))})})]})]}),r.portfolio_links&&r.portfolio_links.length>0&&(0,t.jsxs)(c.Zp,{children:[(0,t.jsxs)(c.aR,{children:[(0,t.jsx)(c.ZB,{children:"Portfolio"}),(0,t.jsx)(c.BT,{children:"Check out my work and projects"})]}),(0,t.jsx)(c.Wu,{children:(0,t.jsx)("div",{className:"space-y-2",children:r.portfolio_links.map((e,r)=>(0,t.jsxs)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-3 border rounded-lg hover:bg-muted transition-colors",children:[(0,t.jsx)("svg",{className:"w-4 h-4 text-muted-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),(0,t.jsx)("span",{className:"text-blue-600 hover:underline truncate",children:e})]},r))})})]}),r.intro_video_url&&(0,t.jsxs)(c.Zp,{children:[(0,t.jsxs)(c.aR,{children:[(0,t.jsx)(c.ZB,{children:"Introduction Video"}),(0,t.jsx)(c.BT,{children:"Get to know me better"})]}),(0,t.jsx)(c.Wu,{children:(0,t.jsx)("div",{className:"aspect-video rounded-lg overflow-hidden",children:(0,t.jsx)("video",{src:r.intro_video_url,controls:!0,className:"w-full h-full object-cover",children:"Your browser does not support the video tag."})})})]})]})}var u=s(2177),h=s(3560),m=s(927),x=s(2523),p=s(5057),f=s(8539),v=s(9434);function b(e){let{type:r,bucket:s,path:l,onUpload:a,maxSize:n=0xa00000,accept:c,className:d,currentUrl:u}=e,[h,m]=(0,i.useState)(!1),[x,p]=(0,i.useState)(u||null),[f,b]=(0,i.useState)(null),j=(0,i.useRef)(null),g=async e=>{var t;let i=null==(t=e.target.files)?void 0:t[0];if(i){if(b(null),i.size>n)return void b("File size must be less than ".concat(Math.round(n/1048576),"MB"));if("image"===r&&!i.type.startsWith("image/"))return void b("Please select an image file");if("video"===r&&!i.type.startsWith("video/"))return void b("Please select a video file");try{m(!0);let e=URL.createObjectURL(i);p(e);let r=new FormData;r.append("file",i),r.append("bucket",s),r.append("path",l);let t=await fetch("/api/users/media/upload",{method:"POST",body:r});if(!t.ok){let e=await t.json();throw Error(e.error||"Upload failed")}let{url:n}=await t.json();a(n)}catch(e){console.error("Upload error:",e),b("Failed to upload file. Please try again."),p(null),a(null)}finally{m(!1)}}},y=async()=>{try{p(null),a(null),j.current&&(j.current.value="")}catch(e){console.error("Remove error:",e)}},N=()=>{var e;null==(e=j.current)||e.click()};return(0,t.jsxs)("div",{className:(0,v.cn)("space-y-2",d),children:[(0,t.jsx)("input",{ref:j,type:"file",accept:c,onChange:g,className:"hidden"}),(0,t.jsx)("div",{className:(0,v.cn)("border-2 border-dashed border-muted-foreground/25 rounded-lg overflow-hidden",d),children:x?(0,t.jsxs)("div",{className:"relative group",children:["image"===r?(0,t.jsx)("img",{src:x,alt:"Preview",className:"w-full h-full object-cover"}):(0,t.jsx)("video",{src:x,className:"w-full h-full object-cover",controls:!0}),(0,t.jsx)("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(o.$,{size:"sm",variant:"secondary",onClick:N,disabled:h,children:"Change"}),(0,t.jsx)(o.$,{size:"sm",variant:"destructive",onClick:y,disabled:h,children:"Remove"})]})})]}):(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center p-6 text-center",children:[(0,t.jsx)("div",{className:"mb-4",children:"image"===r?(0,t.jsx)("svg",{className:"w-12 h-12 text-muted-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}):(0,t.jsx)("svg",{className:"w-12 h-12 text-muted-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"image"===r?"Upload an image":"Upload a video"}),(0,t.jsx)(o.$,{variant:"outline",onClick:N,disabled:h,children:h?"Uploading...":"Choose File"})]})}),f&&(0,t.jsx)("p",{className:"text-sm text-destructive",children:f}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Max size: ",Math.round(n/1048576),"MB"]})]})}let j=m.Ik({display_name:m.Yj().min(2,"Display name must be at least 2 characters").max(50,"Display name must be less than 50 characters"),bio:m.Yj().max(500,"Bio must be less than 500 characters").optional(),hubspot_experience:m.Yj().max(200,"Experience must be less than 200 characters").optional(),skills:m.YO(m.Yj()).max(10,"Maximum 10 skills allowed"),portfolio_links:m.YO(m.Yj().url("Must be a valid URL")).max(5,"Maximum 5 portfolio links allowed")});function g(e){let{user:r,onSuccess:s}=e,[l,a]=(0,i.useState)(!1),[d,m]=(0,i.useState)(""),[v,g]=(0,i.useState)(""),[y,N]=(0,i.useState)(null),[w,_]=(0,i.useState)(null),[k,S]=(0,i.useState)(null),{register:C,handleSubmit:E,formState:{errors:B},setValue:R,watch:P,reset:L}=(0,u.mN)({resolver:(0,h.u)(j),defaultValues:{display_name:r.display_name||"",bio:"",hubspot_experience:"",skills:[],portfolio_links:[]}}),M=P("skills")||[],T=P("portfolio_links")||[],z=()=>{d.trim()&&M.length<10&&!M.includes(d.trim())&&(R("skills",[...M,d.trim()]),m(""))},Z=()=>{if(v.trim()&&T.length<5&&!T.includes(v.trim()))try{new URL(v.trim()),R("portfolio_links",[...T,v.trim()]),g("")}catch(e){}},A=async e=>{try{a(!0);let r={display_name:e.display_name,bio:e.bio||void 0,hubspot_experience:e.hubspot_experience||void 0,skills:e.skills,portfolio_links:e.portfolio_links,profile_picture_url:y||void 0,banner_image_url:w||void 0,intro_video_url:k||void 0},t=await fetch("/api/users/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to update profile")}null==s||s()}catch(e){console.error("Error updating profile:",e)}finally{a(!1)}};return(0,t.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,t.jsxs)(c.Zp,{children:[(0,t.jsxs)(c.aR,{children:[(0,t.jsx)(c.ZB,{children:"Profile Media"}),(0,t.jsx)(c.BT,{children:"Upload your profile picture, banner image, and introduction video"})]}),(0,t.jsx)(c.Wu,{className:"space-y-6",children:(0,t.jsxs)("div",{className:"grid md:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(p.J,{children:"Profile Picture"}),(0,t.jsx)(b,{type:"image",bucket:"profile-pictures",path:"".concat(r.id,"/profile-picture"),onUpload:N,maxSize:5242880,accept:"image/*",className:"aspect-square"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(p.J,{children:"Banner Image"}),(0,t.jsx)(b,{type:"image",bucket:"banner-images",path:"".concat(r.id,"/banner"),onUpload:_,maxSize:0xa00000,accept:"image/*",className:"aspect-[3/1]"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(p.J,{children:"Introduction Video"}),(0,t.jsx)(b,{type:"video",bucket:"intro-videos",path:"".concat(r.id,"/intro-video"),onUpload:S,maxSize:0x3200000,accept:"video/*",className:"aspect-video"})]})]})})]}),(0,t.jsxs)(c.Zp,{children:[(0,t.jsxs)(c.aR,{children:[(0,t.jsx)(c.ZB,{children:"Profile Information"}),(0,t.jsx)(c.BT,{children:"Tell the community about yourself and your HubSpot expertise"})]}),(0,t.jsx)(c.Wu,{children:(0,t.jsxs)("form",{onSubmit:E(A),className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(p.J,{htmlFor:"display_name",children:"Display Name *"}),(0,t.jsx)(x.p,{id:"display_name",...C("display_name"),placeholder:"Your display name"}),B.display_name&&(0,t.jsx)("p",{className:"text-sm text-destructive",children:B.display_name.message})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(p.J,{htmlFor:"bio",children:"Bio"}),(0,t.jsx)(f.T,{id:"bio",...C("bio"),placeholder:"Tell us about yourself...",rows:4}),B.bio&&(0,t.jsx)("p",{className:"text-sm text-destructive",children:B.bio.message})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(p.J,{htmlFor:"hubspot_experience",children:"HubSpot Experience"}),(0,t.jsx)(f.T,{id:"hubspot_experience",...C("hubspot_experience"),placeholder:"Describe your experience with HubSpot...",rows:3}),B.hubspot_experience&&(0,t.jsx)("p",{className:"text-sm text-destructive",children:B.hubspot_experience.message})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(p.J,{children:"Skills"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(x.p,{value:d,onChange:e=>m(e.target.value),placeholder:"Add a skill...",onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),z())}),(0,t.jsx)(o.$,{type:"button",onClick:z,variant:"outline",children:"Add"})]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:M.map(e=>(0,t.jsxs)(n.E,{variant:"secondary",className:"cursor-pointer",onClick:()=>{R("skills",M.filter(r=>r!==e))},children:[e," \xd7"]},e))}),B.skills&&(0,t.jsx)("p",{className:"text-sm text-destructive",children:B.skills.message})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(p.J,{children:"Portfolio Links"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(x.p,{value:v,onChange:e=>g(e.target.value),placeholder:"https://your-portfolio.com",onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),Z())}),(0,t.jsx)(o.$,{type:"button",onClick:Z,variant:"outline",children:"Add"})]}),(0,t.jsx)("div",{className:"space-y-2",children:T.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-2 bg-muted rounded",children:[(0,t.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:underline truncate",children:e}),(0,t.jsx)(o.$,{type:"button",variant:"ghost",size:"sm",onClick:()=>{R("portfolio_links",T.filter(r=>r!==e))},children:"\xd7"})]},e))}),B.portfolio_links&&(0,t.jsx)("p",{className:"text-sm text-destructive",children:B.portfolio_links.message})]}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)(o.$,{type:"submit",disabled:l,children:l?"Saving...":"Save Profile"}),(0,t.jsx)(o.$,{type:"button",variant:"outline",onClick:()=>L(),children:"Reset"})]})]})})]})]})}function y(){let{user:e}=(0,l.A)(),[r,s]=(0,i.useState)(!1),[n,c]=(0,i.useState)(null),[u,h]=(0,i.useState)(!0);(0,i.useEffect)(()=>{(async()=>{if(e)try{let e=await fetch("/api/users/profile");if(e.ok){let r=await e.json();c({id:r.id,email:r.email,hubspot_id:r.hubspot_id,display_name:r.display_name,role:r.role,verification_status:r.verification_status,bio:r.bio||void 0,skills:r.skills||[],hubspot_experience:r.hubspot_experience||void 0,portfolio_links:r.portfolio_links||[],profile_picture_url:r.profile_picture_url||void 0,banner_image_url:r.banner_image_url||void 0,intro_video_url:r.intro_video_url||void 0})}}catch(e){console.error("Error fetching profile:",e)}finally{h(!1)}})()},[e]);let m=async()=>{s(!1);try{let e=await fetch("/api/users/profile");if(e.ok){let r=await e.json();c({id:r.id,email:r.email,hubspot_id:r.hubspot_id,display_name:r.display_name,role:r.role,verification_status:r.verification_status,bio:r.bio||void 0,skills:r.skills||[],hubspot_experience:r.hubspot_experience||void 0,portfolio_links:r.portfolio_links||[],profile_picture_url:r.profile_picture_url||void 0,banner_image_url:r.banner_image_url||void 0,intro_video_url:r.intro_video_url||void 0})}}catch(e){console.error("Error refreshing profile:",e)}};return u?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary"})}):(0,t.jsx)(a.O,{children:(0,t.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:r?"Edit Profile":"My Profile"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:r?"Update your profile information and media":"Manage your profile and showcase your HubSpot expertise"})]}),!r&&(0,t.jsx)(o.$,{onClick:()=>s(!0),children:"Edit Profile"})]}),r?(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"flex gap-4",children:(0,t.jsx)(o.$,{variant:"outline",onClick:()=>s(!1),children:"Cancel"})}),e&&(0,t.jsx)(g,{user:e,onSuccess:m})]}):n&&(0,t.jsx)(d,{user:n,isOwnProfile:!0,onEdit:()=>s(!0)})]})})})}},9434:(e,r,s)=>{"use strict";s.d(r,{cn:()=>l});var t=s(2596),i=s(9688);function l(){for(var e=arguments.length,r=Array(e),s=0;s<e;s++)r[s]=arguments[s];return(0,i.QP)((0,t.$)(r))}}},e=>{e.O(0,[579,352,647,441,964,358],()=>e(e.s=5032)),_N_E=e.O()}]);